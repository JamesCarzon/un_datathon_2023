---
title: "GP_modeling"
author: "James Carzon"
date: "11/4/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{python}
import numpy as np
import pandas as pd
import sklearn.gaussian_process as gp
import scipy
import matplotlib.pyplot as plt
```

```{python}
data = pd.read_csv("../DATA/processed_data.csv", index_col=0)
data['elevation'] = 10*scipy.stats.norm.rvs(size=data.shape[0]) # Fake elevation values
```

We specify a Matern kernel with shape parameter 1.5 and with a vector of 
initial length scales equal to 1.

```{python}
kernel = gp.kernels.Matern(
  length_scale=[1.0]*5,
  length_scale_bounds=(10e-10, 10e10),
  nu=1.5
)

model = gp.GaussianProcessRegressor(
  kernel,
  optimizer='fmin_l_bfgs_b',
  random_state=2023
)
```

Specify input data X and y.

```{python}
X = data[['latitude', 'longitude', 'popdens', 'elevation', 'plant_dist']].sample(1000, random_state=2023)
y = data[['NO2gm']].sample(1000, random_state=2023)
```

Fit the model by learning the length scales by MLE, and read the learned 
parameters.

```{python}
model.fit(X, y)

model.kernel_.get_params()
```
