---
title: "GP_modeling"
author: "James Carzon"
date: "11/4/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{python}
import numpy as np
import pandas as pd
import sklearn.gaussian_process as gp
import scipy
import matplotlib.pyplot as plt
```

```{python}
data = pd.read_csv("../DATA/regridded_data.csv", index_col=0)
data['elevation'] = 10*scipy.stats.norm.rvs(size=data.shape[0])
data['dist_to_plant'] = 10*scipy.stats.norm.rvs(size=data.shape[0])
data = data.dropna(axis=0)


```

```{python}
kernel = gp.kernels.Matern(
  length_scale=[1.0]*5,
  length_scale_bounds=(10e-10, 10e10),
  nu=1.5
)

model = gp.GaussianProcessRegressor(
  kernel,
  optimizer='fmin_l_bfgs_b',
  random_state=2023
)
```

```{python}
X = data[['latitude', 'longitude', 'popdens', 'elevation', 'dist_to_plant']].sample(n=1000, random_state=2023)
y = data[['NO2gm']].sample(n=1000, random_state=2023)

X.shape
```

```{python}
model.fit(X, y)

model.kernel_.get_params()
```

